"use strict";(self.webpackChunkagape_app=self.webpackChunkagape_app||[]).push([[277],{277:(e,t,n)=>{n.d(t,{default:()=>v});var r=n(950),u=n(43),s=n.n(u);var c=n(974);const o=Symbol("FORM_EVENT_ACTION_SUCCESS"),a=Symbol("FORM_EVENT_ACTION_ERROR"),i=Symbol("FORM_EVENT_MERGE_STATE"),l=Symbol("FORM_EVENT_SET_STATE"),f=(0,r.createContext)({});function m(e){const{action:t,initState:n={},...u}=e,s=(0,r.useRef)((0,r.useMemo)((()=>{return{state:{},emitter:{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map((function(e){e(n)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,n)}))}}};var e}),[]));(0,r.useMemo)((()=>s.current.state=n),[n]),(0,r.useEffect)((()=>{const{emitter:e}=s.current;return()=>e.all.clear()}),[]);const{emitter:i}=s.current;return(0,c.jsx)(f.Provider,{value:s,children:(0,c.jsx)("form",{...u,onSubmit:e=>{e.preventDefault(),e.stopPropagation();const{current:{state:n}}=s;t(n).then((e=>{i.emit(o,e)})).catch((e=>{i.emit(a,e)}))}})})}const p={Text:function(e){const{name:t,...n}=e,[u,o]=function(e,t){const n=(0,r.useContext)(f),[u,c]=(0,r.useState)((()=>{var r;return null!==(r=s().get(n.current.state,e))&&void 0!==r?r:t}));(0,r.useEffect)((()=>n.current.emitter.on(l,(()=>{var r;c(null!==(r=s().get(n.current.state,e))&&void 0!==r?r:t)}))),[t,e,n]),(0,r.useEffect)((()=>n.current.emitter.on(i,(t=>{s().has(t,e)&&c(s().get(t,e))}))),[t,e,n]);const o=(0,r.useCallback)((t=>{s().set(n.current.state,e,t),c(t)}),[e,n]);return[u,o]}(t,"");return(0,c.jsx)("input",{...n,type:"text",value:u,onChange:e=>{let{currentTarget:t}=e;return o(t.value)}})}};var x=n(619);function E(){const e=function(){const e=(0,r.useContext)(f),[t,n]=(0,r.useState)();return(0,r.useEffect)((()=>e.current.emitter.on(o,(e=>{n(e)}))),[e]),t}(),[t,n]=(0,r.useState)(""),u=function(){const e=(0,r.useContext)(f);return(0,r.useMemo)((()=>{const{emitter:t}=e.current,n=(e,n)=>t.on(e,n),r=n=>{s().merge(e.current.state,n),t.emit(i,n)};return new Proxy(t,{get(e,t){switch(t){case"on":return n;case"merge":return r;default:return n=>e.emit(t,n)}}})}),[e])}();return(0,r.useEffect)((()=>u.on("sayFoo",n)),[u]),e?(0,c.jsx)("span",{children:e}):(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{onClick:()=>u.sayFoo("foo"),children:"Emitter"}),(0,c.jsx)("span",{children:t})]})}const v=function(){return(0,c.jsxs)(m,{action:x.sayHello,children:[(0,c.jsx)(p.Text,{name:"fullName"}),(0,c.jsx)(p.Text,{name:"foo.fullName"}),(0,c.jsx)(E,{}),(0,c.jsx)("input",{type:"submit",value:"Enviar"})]})}}}]);
//# sourceMappingURL=277.b7f7f5ca.chunk.js.map